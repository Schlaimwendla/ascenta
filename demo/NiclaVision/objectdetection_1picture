
import sensor
import time
import ml

sensor.reset()
sensor.set_pixformat(sensor.RGB565)
sensor.set_framesize(sensor.QVGA)
sensor.set_windowing((240, 240))
sensor.skip_frames(time=2000)

model = ml.Model("trained")

THRESHOLD = 0.7

img = sensor.snapshot()

result = model.predict([img])[0].flatten().tolist()

best_index = max(range(len(result)), key=lambda i: result[i])
best_label = model.labels[best_index]
best_conf = result[best_index]

if best_conf >= THRESHOLD:
    print("Detected:", best_label, "Confidence:", best_conf)
else:
    print("uncertain")
